<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>neuron. nat 1.8.6</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">nat 1.8.6</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="reference.html">Reference</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <div class="container">
      <header>
        
      </header>
      
      <h1>neuron: class to represent traced neurons</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='neuron.html'>neuron</a></span><span class="keyword">(</span><span class="symbol">d</span><span class="keyword">,</span> <span class="argument">NumPoints</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span><span class="keyword">(</span><span class="symbol">d</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">StartPoint</span><span class="keyword">,</span> <span class="argument">BranchPoints</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/integer'>integer</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="symbol">EndPoints</span><span class="keyword">,</span> <span class="symbol">SegList</span><span class="keyword">,</span> <span class="argument">SubTrees</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="argument">InputFileName</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span>
  <span class="argument">NeuronName</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">,</span> <span class="argument">MD5</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">TRUE</span><span class="keyword">)</span>

<span class="functioncall"><a href='neuron.html'>is.neuron</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">Strict</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">FALSE</span><span class="keyword">)</span>

<span class="functioncall"><a href='neuron.html'>as.neuron</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="comment"># S3 method for data.frame</span>
<span class="functioncall"><a href='neuron.html'>as.neuron</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="comment"># S3 method for ngraph</span>
<span class="functioncall"><a href='neuron.html'>as.neuron</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">vertexData</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="argument">origin</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span>
  <span class="argument">Verbose</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">FALSE</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="comment"># S3 method for default</span>
<span class="functioncall"><a href='neuron.html'>as.neuron</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>d</dt>
      <dd>matrix of vertices and associated data in SWC format</dd>
      <dt>NumPoints</dt>
      <dd>Number of points in master subtree</dd>
      <dt>StartPoint, BranchPoints, EndPoints</dt>
      <dd>Nodes of the neuron</dd>
      <dt>SegList</dt>
      <dd>List where each element contains the vertex indices for a 
single segments of the neuron, starting at root.</dd>
      <dt>SubTrees</dt>
      <dd>List of SegLists where a neuron has multiple unconnected 
trees (e.g. because the soma is not part of the graph, or because the 
neuronal arbour has been cut.)</dd>
      <dt>InputFileName</dt>
      <dd>Character vector with path to input file</dd>
      <dt>NeuronName</dt>
      <dd>Character vector containing name of neuron or a function 
with one argument (the full path) which returns the name. The default
(<code>NULL</code>) sets NeuronName to the file name without the file extension.</dd>
      <dt>...</dt>
      <dd>Additional fields to be included in neuron. Note that if these 
include CreatedAt, NodeName, InputFileStat or InputFileMD5, they will 
override fields of that name that are calculated automatically.</dd>
      <dt>MD5</dt>
      <dd>Logical indicating whether to calculate MD5 hash of input</dd>
      <dt>x</dt>
      <dd>A neuron or other object to test/convert</dd>
      <dt>Strict</dt>
      <dd>Whether to check class of neuron or use a more relaxed
definition based on object being a list with a SegList component.</dd>
      <dt>vertexData</dt>
      <dd>A dataframe with SWC fields especially X,Y,Z,W,PointNo,
Parent.</dd>
      <dt>origin</dt>
      <dd>Root vertex, matched against labels (aka PointNo) when 
available (see details)</dd>
      <dt>Verbose</dt>
      <dd>Whether to be verbose (default: FALSE)</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
A list with elements: 
  (NumPoints,StartPoint,BranchPoints,EndPoints,nTrees,NumSegs,SegList, 
  [SubTrees]) NB SubTrees will only be present when nTrees&gt;1.
</dl></p>

    </div>

    <div class="Description">
      <h2>Description</h2>

      <p><code>neuron</code> makes a neuron object from appropriate variables.</p>

      <p><code>is.neuron</code> will check if an object looks like a neuron.</p>

      <p><code>as.neuron</code> will convert a suitable object to a neuron</p>

      <p><code>as.neuron.data.frame</code> expects a block of SWC format data</p>

      <p><code>as.neuron.ngraph</code> converts a graph (typically an 
  <code>ngraph</code> object) to a neuron</p>

      <p><code>as.neuron.default</code> will add class &quot;neuron&quot; to a neuron-like
  object.</p>

    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>neuron objects consist of a list containing multiple fields describing the 3D
location and connectivity of points in a traced neuron. The critical fields 
of a neuron, n, are n$d which contains a dataframe in SWC format and 
n$SegList which contains a representation of the neuron&#39;s topology used for 
most internal calculations. For historical reasons, n$SegList is limited to a
<em>single fully-connected</em> tree. If the tree contains multiple unconnected
subtrees, then these are stored in n$SubTrees and nTrees will be &gt;1; the 
&quot;master&quot; subtree (typically the one with the most points) will then be stored
in n$SegList and n$NumPoints will refer to the number of points in that 
subtree, not the whole neuron.</p>

      <p>StartPoint, BranchPoints, EndPoints are indices matching the rows of 
  the vertices in <code>d</code> <strong>not</strong> arbitrary point numbers typically 
  encoded in <code>d$PointNo</code>.</p>

      <p>Columns will be ordered c(&#39;PointNo&#39;,&#39;Label&#39;,&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;,&#39;W&#39;,&#39;Parent&#39;)</p>

      <p>Uses a depth first search on the tree to reorder using the given 
  origin.</p>

      <p>When the graph contains multiple subgraphs, only one will be chosen 
  as the master tree and used to construct the SegList of the resultant 
  neuron. However all subgraphs will be listed in the SubTrees element of the
  neuron and nTrees will be set appropriately.</p>

      <p>When the graph vertices have a label attribute derived from PointNo,
  the origin is assumed to be specified with respect to the vertex labels 
  rather than the raw vertex ids.</p>

    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="comment">## See help for functions listed in See Also for more detailed examples</span>
<span class="comment">## Basic properties</span>
<span class="comment"># a sample neuron </span>
<span class="symbol">n</span> <span class="assignement">=</span> <span class="symbol">Cell07PNs</span><span class="keyword">[[</span><span class="number">1</span><span class="keyword">]</span><span class="keyword">]</span>
<span class="comment"># inspect its internal structure</span>
<span class="functioncall"><a href='http://www.rdocumentation.org/packages/utils/topics/str'>str</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span></div>
<div class='output'>List of 24
 $ CellType     : chr &quot;DA1&quot;
 $ NeuronName   : chr &quot;EBH11R&quot;
 $ InputFileName:Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
 $ CreatedAt    : POSIXt[1:1], format: &quot;2006-01-17 15:21:14&quot;
 $ NodeName     : Named chr &quot;jefferis.joh.cam.ac.uk&quot;
  ..- attr(*, &quot;names&quot;)= chr &quot;nodename&quot;
 $ InputFileStat:&#39;data.frame&#39;:	1 obs. of  10 variables:
  ..$ size  : num 15379
  ..$ isdir : logi FALSE
  ..$ mode  :Class &#39;octmode&#39;  int 420
  ..$ mtime : POSIXt[1:1], format: &quot;2006-01-12 00:52:01&quot;
  ..$ ctime : POSIXt[1:1], format: &quot;2006-01-12 00:52:01&quot;
  ..$ atime : POSIXt[1:1], format: &quot;2006-01-17 15:21:14&quot;
  ..$ uid   : int 501
  ..$ gid   : int 501
  ..$ uname : chr &quot;jefferis&quot;
  ..$ grname: chr &quot;jefferis&quot;
 $ InputFileMD5 : Named chr &quot;fcacee3f874cbe2c6ad96214e6fee337&quot;
  ..- attr(*, &quot;names&quot;)=Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
 $ NumPoints    : int 180
 $ StartPoint   : num 1
 $ BranchPoints : num [1:16] 34 48 51 75 78 95 98 99 108 109 ...
 $ EndPoints    : num [1:18] 1 42 59 62 80 85 96 100 102 112 ...
 $ NumSegs      : int 33
 $ SegList      :List of 33
  ..$ : int [1:34] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ : int [1:9] 34 35 36 37 38 39 40 41 42
  ..$ : num [1:7] 34 43 44 45 46 47 48
  ..$ : int [1:4] 48 49 50 51
  ..$ : int [1:9] 51 52 53 54 55 56 57 58 59
  ..$ : num [1:4] 51 60 61 62
  ..$ : num [1:14] 48 63 64 65 66 67 68 69 70 71 ...
  ..$ : int [1:4] 75 76 77 78
  ..$ : int [1:3] 78 79 80
  ..$ : num [1:6] 78 81 82 83 84 85
  ..$ : num [1:11] 75 86 87 88 89 90 91 92 93 94 ...
  ..$ : int [1:2] 95 96
  ..$ : num [1:3] 95 97 98
  ..$ : int [1:2] 98 99
  ..$ : int [1:2] 99 100
  ..$ : num [1:3] 99 101 102
  ..$ : num [1:7] 98 103 104 105 106 107 108
  ..$ : int [1:2] 108 109
  ..$ : int [1:4] 109 110 111 112
  ..$ : num [1:4] 109 113 114 115
  ..$ : int [1:3] 115 116 117
  ..$ : num [1:3] 115 118 119
  ..$ : int [1:3] 119 120 121
  ..$ : num [1:14] 119 122 123 124 125 126 127 128 129 130 ...
  ..$ : num [1:2] 108 135
  ..$ : int [1:9] 135 136 137 138 139 140 141 142 143
  ..$ : int [1:6] 143 144 145 146 147 148
  ..$ : num [1:7] 143 149 150 151 152 153 154
  ..$ : num [1:7] 135 155 156 157 158 159 160
  ..$ : int [1:6] 160 161 162 163 164 165
  ..$ : num [1:5] 160 166 167 168 169
  ..$ : int [1:4] 169 170 171 172
  ..$ : num [1:9] 169 173 174 175 176 177 178 179 180
 $ d            :&#39;data.frame&#39;:	180 obs. of  7 variables:
  ..$ PointNo: int [1:180] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ Label  : num [1:180] 2 2 2 2 2 2 2 2 2 2 ...
  ..$ X      : num [1:180] 187 187 188 188 188 ...
  ..$ Y      : num [1:180] 133 131 130 129 129 ...
  ..$ Z      : num [1:180] 88.2 90.6 93.1 95 97.5 ...
  ..$ W      : num [1:180] 1.01 1.27 1.14 1.27 1.27 1.27 1.27 1.27 1.27 1.27 ...
  ..$ Parent : num [1:180] -1 1 2 3 4 5 6 7 8 9 ...
 $ OrientInfo   :List of 5
  ..$ AxonOriented: logi TRUE
  ..$ AVMPoint    : logi NA
  ..$ AVLPoint    : logi NA
  ..$ Scl         : num [1:3] 1 1 1
  ..$ NewAxes     : num [1:3] 1 2 3
 $ SegOrders    : num [1:33] 1 2 2 3 4 4 3 4 5 5 ...
 $ MBPoints     : int [1:2] 34 48
 $ LHBranchPoint: int 75
 $ SegTypes     : num [1:33] 1 3 1 3 3 3 1 2 2 2 ...
 $ AxonSegNos   :List of 3
  ..$ PreMBAxons : int 1
  ..$ MBAxons    : int 3
  ..$ PostMBAxons: int 7
 $ LHSegNos     : num [1:26] 8 9 10 11 12 13 14 15 16 17 ...
 $ MBSegNos     :List of 2
  ..$ : int 2
  ..$ : num [1:3] 4 5 6
 $ NumMBBranches: num 2
 $ AxonLHEP     : num 72
 - attr(*, &quot;class&quot;)= chr [1:2] &quot;neuron&quot; &quot;list&quot;
</div>
<div class='input'><span class="comment"># summary of 3D points</span>
<span class="functioncall"><a href='summary.neuron.html'>summary</a></span><span class="keyword">(</span><span class="functioncall"><a href='xyzmatrix.html'>xyzmatrix</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>       X               Y                Z        
 Min.   :186.9   Min.   : 90.36   Min.   : 88.2  
 1st Qu.:225.6   1st Qu.: 97.56   1st Qu.:103.4  
 Median :258.4   Median :102.70   Median :112.9  
 Mean   :249.4   Mean   :104.03   Mean   :120.9  
 3rd Qu.:277.7   3rd Qu.:109.04   3rd Qu.:139.0  
 Max.   :289.5   Max.   :132.71   Max.   :157.3  
</div>
<div class='input'><span class="comment"># identify 3d location of endpoints</span>
<span class="functioncall"><a href='xyzmatrix.html'>xyzmatrix</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span><span class="keyword">[</span><span class="functioncall"><a href='rootpoints.html'>endpoints</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span><span class="keyword">,</span><span class="keyword">]</span></div>
<div class='output'>           X         Y         Z
1   186.8660 132.70932  88.20393
42  224.7067 109.86362 153.58749
59  229.6343  92.30637 157.29700
62  226.8855  90.36325 147.59602
80  249.8864  93.59079 136.77795
85  253.0099  90.94904 137.34921
96  264.0801  98.53390 121.89463
100 266.3223  98.73241 116.46558
102 267.5460  98.59859 112.85608
112 271.0762 102.67288 100.84955
117 274.6128 100.92061 103.28772
121 277.3920 102.19148 102.69473
134 287.1214 101.43365 103.30740
148 281.7958  96.63987 101.08075
154 276.6551  95.09809  99.22113
165 278.3287 113.75627 104.87700
172 282.3069 111.93213 105.65492
180 289.5364 111.96014 109.18281
</div>
<div class='input'>
<span class="comment">## Neurons as graphs</span>
<span class="comment"># convert to graph and find longest paths by number of nodes</span>
<span class="symbol">ng</span><span class="assignement">=</span><span class="functioncall"><a href='ngraph.html'>as.ngraph</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span>
<span class="functioncall"><a href='http://www.rdocumentation.org/packages/graphics/topics/hist'>hist</a></span><span class="keyword">(</span><span class="package">igraph</span><span class="keyword">::</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/igraph/topics/distances'>distances</a></span><span class="keyword">(</span><span class="symbol">ng</span><span class="keyword">)</span><span class="keyword">)</span></div>
<p><img src='neuron-8.png' alt='' width='540' height='400' /></p>
<div class='input'><span class="comment"># ... or in distances  microns</span>
<span class="symbol">ngw</span><span class="assignement">=</span><span class="functioncall"><a href='ngraph.html'>as.ngraph</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">,</span> <span class="argument">weights</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span>
<span class="functioncall"><a href='http://www.rdocumentation.org/packages/graphics/topics/hist'>hist</a></span><span class="keyword">(</span><span class="package">igraph</span><span class="keyword">::</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/igraph/topics/distances'>distances</a></span><span class="keyword">(</span><span class="symbol">ngw</span><span class="keyword">)</span><span class="keyword">)</span></div>
<p><img src='neuron-10.png' alt='' width='540' height='400' /></p>
<div class='input'>
<span class="comment">## Other methods</span>
<span class="comment"># plot</span>
<span class="functioncall"><a href='http://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span><span class="keyword">(</span><span class="symbol">n</span><span class="keyword">)</span></div>
<p><img src='neuron-12.png' alt='' width='540' height='400' /></p>
<div class='input'><span class="comment"># all methods for neuron objects</span>
<span class="functioncall"><a href='http://www.rdocumentation.org/packages/utils/topics/methods'>methods</a></span><span class="keyword">(</span><span class="argument">class</span> <span class="argument">=</span> <span class="string">'neuron'</span><span class="keyword">)</span></div>
<div class='output'> [1] -                  *                  /                  +                  all.equal          as.neuron         
 [7] as.ngraph          as.seglist         boundingbox        branchpoints       dotprops           endpoints         
[13] ndigest            plot               plot3d             potential_synapses prune              resample          
[19] rootpoints         scale              subset             summary            write.vtk          xform             
[25] xyzmatrix          xyzmatrix&lt;-       
see &#39;?methods&#39; for accessing help and source code
</div></pre>
  </div>
  <div class="span4 sidebar">
    <!-- <ul>
      <li>as.neuron</li><li>as.neuron.data.frame</li><li>as.neuron.default</li><li>as.neuron.ngraph</li><li>is.neuron</li><li>neuron</li>
    </ul>
    <ul>
      
    </ul> -->

    <h2>See also</h2>
      <p><code><a href='neuronlist.html'>neuronlist</a></code></p>

      <p><code><a href='http://www.rdocumentation.org/packages/igraph/topics/dfs'>graph.dfs</a>, <a href='seglist.html'>as.seglist</a></code></p>

      <p>Other neuron: <code><a href='ngraph.html'>ngraph</a></code>,
  <code><a href='plot.neuron.html'>plot.neuron</a></code>,
  <code><a href='potential_synapses.html'>potential_synapses</a></code>, <code><a href='prune.html'>prune</a></code>,
  <code><a href='resample.html'>resample</a></code>, <code><a href='rootpoints.html'>rootpoints</a></code>,
  <code><a href='spine.html'>spine</a></code>, <code><a href='subset.neuron.html'>subset.neuron</a></code></p>

    


  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="https://getbootstrap.com/2.0.4/">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>