<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>plot3d.neuronlist. nat 1.8.6</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">nat 1.8.6</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="reference.html">Reference</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <div class="container">
      <header>
        
      </header>
      
      <h1>3D plots of the elements in a neuronlist, optionally using a subset 
expression</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="comment"># S3 method for neuronlist</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">subset</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="argument">col</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span>
  <span class="argument">colpal</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="symbol">rainbow</span><span class="keyword">,</span> <span class="argument">skipRedraw</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/ifelse'>ifelse</a></span><span class="keyword">(</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="number">200L</span><span class="keyword">,</span> <span class="number">TRUE</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="argument">WithNodes</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">FALSE</span><span class="keyword">,</span> <span class="argument">soma</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">FALSE</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">,</span> <span class="argument">SUBSTITUTE</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">TRUE</span><span class="keyword">)</span>

<span class="comment"># S3 method for character</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">db</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>x</dt>
      <dd>a neuron list or, for <code>plot3d.character</code>, a character vector of
neuron names. The default neuronlist used by plot3d.character can be set by
using <code>options(nat.default.neuronlist=&#39;mylist&#39;)</code>. See 
?<code><a href='nat-package.html'>nat</a></code> for details. <code><a href='nat-package.html'>nat-package</a></code>.</dd>
      <dt>subset</dt>
      <dd>Expression evaluating to logical mask for neurons. See details.</dd>
      <dt>col</dt>
      <dd>An expression specifying a colour evaluated in the context of the 
dataframe attached to nl (after any subsetting). See details.</dd>
      <dt>colpal</dt>
      <dd>A vector of colours or a function that generates colours</dd>
      <dt>skipRedraw</dt>
      <dd>When plotting more than this many (default 200) neurons 
skip redraw for individual neurons (this is much faster for large number of
neurons). Can also accept logical values TRUE (always skip) FALSE (never 
skip).</dd>
      <dt>WithNodes</dt>
      <dd>Whether to plot points for end/branch points. Default: 
<code>FALSE</code>.</dd>
      <dt>soma</dt>
      <dd>Whether to plot a sphere at neuron&#39;s origin representing the 
soma. Either a logical value or a numeric indicating the radius (default 
<code>FALSE</code>). When <code>soma=TRUE</code> the radius is hard coded to 2.</dd>
      <dt>...</dt>
      <dd>options passed on to plot3d (such as colours, line width etc)</dd>
      <dt>SUBSTITUTE</dt>
      <dd>Whether to <code>substitute</code> the expressions passed as 
arguments <code>subset</code> and <code>col</code>. Default: <code>TRUE</code>. For expert 
use only, when calling from another function.</dd>
      <dt>db</dt>
      <dd>A neuronlist to use as the source of objects to plot. If
<code>NULL</code>, the default, will use the neuronlist specified by
options(&#39;nat.default.neuronlist&#39;)</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
list of values of <code>plot3d</code> with subsetted dataframe as attribute
  <code>&#39;df&#39;</code>
</dl></p>

    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>3D plots of the elements in a neuronlist, optionally using a subset 
expression</p>

      <p><code>plot3d.character</code> is a convenience method intended for 
  exploratory work on the command line.</p>

    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>The col and subset parameters are evaluated in the context of the 
  dataframe attribute of the neuronlist. If col evaluates to a factor and 
  colpal is a named vector then colours will be assigned by matching factor 
  levels against the named elements of colpal. If there is one unnamed level,
  this will be used as catch-all default value (see examples).</p>

      <p>If col evaluates to a factor and colpal is a function then it will be used 
  to generate colours with the same number of levels as are used in col.</p>

      <p>WithNodes is <code>FALSE</code> by default when using <code>plot3d.neuronlist</code> 
  but remains <code>TRUE</code> by default when plotting single neurons with 
  <code><a href='plot3d.neuron.html'>plot3d.neuron</a></code>. This is because the nodes quickly make plots 
  with multiple neurons rather busy.</p>

      <p>When <code>soma</code> is <code>TRUE</code> or a vector of numeric values (recycled as 
  appropriate), the values are used to plot cell bodies. For neurons the 
  values are passed to <code>plot3d.neuron</code> for neurons. In contrast 
  <code>dotprops</code> objects still need special handling. There must be columns 
  called <code>X,Y,Z</code> in the data.frame attached to <code>x</code>, that are then 
  used directly by code in <code>plot3d.neuronlist</code>.</p>

      <p>Whenever plot3d.neuronlist is called, it will add an entry to an 
  environment <code>.plotted3d</code> in <code>nat</code> that stores the ids of all the 
  plotted shapes (neurons, cell bodies) so that they can then be removed by a
  call to <code>npop3d</code>.</p>

      <p>plot3d.character will check if options(&#39;nat.default.neuronlist&#39;) has
  been set and then use x as an identifier to find a neuron in that 
  neuronlist.</p>

    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="functioncall"><a href='http://www.rdocumentation.org/packages/rgl/topics/par3d'>open3d</a></span><span class="keyword">(</span><span class="keyword">)</span></div>
<div class='output'>glX 
  7 
</div>
<div class='input'><span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">kcs20</span><span class="keyword">,</span><span class="symbol">type</span>==<span class="string">'gamma'</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="string">'green'</span><span class="keyword">)</span>

<span class="functioncall"><a href='http://www.rdocumentation.org/packages/rgl/topics/scene'>clear3d</a></span><span class="keyword">(</span><span class="keyword">)</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">kcs20</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="symbol">type</span><span class="keyword">)</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">Cell07PNs</span><span class="keyword">,</span><span class="symbol">Glomerulus</span>==<span class="string">"DA1"</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="string">'red'</span><span class="keyword">)</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">Cell07PNs</span><span class="keyword">,</span><span class="symbol">Glomerulus</span>==<span class="string">"VA1d"</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="string">'green'</span><span class="keyword">)</span>
<span class="comment"># Note use of default colour for non DA1 neurons</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">Cell07PNs</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="symbol">Glomerulus</span><span class="keyword">,</span> <span class="argument">colpal</span><span class="argument">=</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="argument">DA1</span><span class="argument">=</span><span class="string">'red'</span><span class="keyword">,</span> <span class="string">'grey'</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="comment"># a subset expression</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">Cell07PNs</span><span class="keyword">,</span><span class="symbol">Glomerulus</span><span class="keyword">%in%</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="string">"DA1"</span><span class="keyword">,</span><span class="string">'VA1d'</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="argument">col</span><span class="argument">=</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="string">"red"</span><span class="keyword">,</span><span class="string">"green"</span><span class="keyword">)</span><span class="keyword">[</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span><span class="keyword">(</span><span class="symbol">Glomerulus</span><span class="keyword">)</span><span class="keyword">]</span><span class="keyword">)</span>
<span class="comment"># the same but not specifying colours explicitly</span>
<span class="functioncall"><a href='plot3d.html'>plot3d</a></span><span class="keyword">(</span><span class="symbol">Cell07PNs</span><span class="keyword">,</span><span class="symbol">Glomerulus</span><span class="keyword">%in%</span><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="string">"DA1"</span><span class="keyword">,</span><span class="string">'VA1d'</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">col</span><span class="argument">=</span><span class="symbol">Glomerulus</span><span class="keyword">)</span>

<span class="comment">## Not run: ------------------------------------</span>
<span class="comment"># ## more complex colouring strategies for a larger neuron set</span>
<span class="comment"># # see https://github.com/jefferis/frulhns for details</span>
<span class="comment"># library(frulhns)</span>
<span class="comment"># # notice the sexually dimorphic projection patterns for these neurons</span>
<span class="comment"># plot3d(jkn,cluster=='aSP-f' &amp;shortGenotype=='JK1029', </span>
<span class="comment">#   col=sex,colpal=c(male='green',female='magenta'))</span>
<span class="comment"># </span>
<span class="comment"># ## colour neurons of a class by input resistance</span>
<span class="comment"># jkn.aspg=subset(jkn, cluster=='aSP-g')</span>
<span class="comment"># # NB this comes in as a factor</span>
<span class="comment"># Ri=with(jkn.aspg,as.numeric(as.character(Ri..GOhm.)))</span>
<span class="comment"># # the matlab jet palette</span>
<span class="comment"># jet.colors&lt;-colorRampPalette(c('navy','cyan','yellow','red'))</span>
<span class="comment"># plot3d(jkn.aspg,col=cut(Ri,20),colpal=jet.colors)</span>
<span class="comment">## ---------------------------------------------</span></div></pre>
  </div>
  <div class="span4 sidebar">
    <!-- <ul>
      <li>plot3d.character</li><li>plot3d.neuronlist</li>
    </ul>
    <ul>
      
    </ul> -->

    <h2>See also</h2>
      <p><code><a href='nat-package.html'>nat-package</a></code></p>

    


  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="https://getbootstrap.com/2.0.4/">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>