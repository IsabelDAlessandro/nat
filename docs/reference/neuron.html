<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>neuron: class to represent traced neurons — neuron • nat</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">nat</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jefferis/nat">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>neuron: class to represent traced neurons</h1>
    </div>

    
    <p><code>neuron</code> makes a neuron object from appropriate variables.</p>

    <p><code>is.neuron</code> will check if an object looks like a neuron.</p>

    <p><code>as.neuron</code> will convert a suitable object to a neuron</p>

    <p><code>as.neuron.data.frame</code> expects a block of SWC format data</p>

    <p><code>as.neuron.ngraph</code> converts a graph (typically an 
  <code>ngraph</code> object) to a neuron</p>

    <p><code>as.neuron.default</code> will add class &quot;neuron&quot; to a neuron-like
  object.</p>
    

    <pre><span class='fu'>neuron</span>(<span class='no'>d</span>, <span class='kw'>NumPoints</span> <span class='kw'>=</span> <span class='fu'>nrow</span>(<span class='no'>d</span>), <span class='no'>StartPoint</span>, <span class='kw'>BranchPoints</span> <span class='kw'>=</span> <span class='fu'>integer</span>(),
  <span class='no'>EndPoints</span>, <span class='no'>SegList</span>, <span class='kw'>SubTrees</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>InputFileName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>NeuronName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>MD5</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>is.neuron</span>(<span class='no'>x</span>, <span class='kw'>Strict</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>as.neuron</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for data.frame</span>
<span class='fu'>as.neuron</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ngraph</span>
<span class='fu'>as.neuron</span>(<span class='no'>x</span>, <span class='kw'>vertexData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>Verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>as.neuron</span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>d</dt>
      <dd>matrix of vertices and associated data in SWC format</dd>
      <dt>NumPoints</dt>
      <dd>Number of points in master subtree</dd>
      <dt>StartPoint, BranchPoints, EndPoints</dt>
      <dd>Nodes of the neuron</dd>
      <dt>SegList</dt>
      <dd>List where each element contains the vertex indices for a 
single segments of the neuron, starting at root.</dd>
      <dt>SubTrees</dt>
      <dd>List of SegLists where a neuron has multiple unconnected 
trees (e.g. because the soma is not part of the graph, or because the 
neuronal arbour has been cut.)</dd>
      <dt>InputFileName</dt>
      <dd>Character vector with path to input file</dd>
      <dt>NeuronName</dt>
      <dd>Character vector containing name of neuron or a function 
with one argument (the full path) which returns the name. The default
(<code>NULL</code>) sets NeuronName to the file name without the file extension.</dd>
      <dt>...</dt>
      <dd>Additional fields to be included in neuron. Note that if these 
include CreatedAt, NodeName, InputFileStat or InputFileMD5, they will 
override fields of that name that are calculated automatically.</dd>
      <dt>MD5</dt>
      <dd>Logical indicating whether to calculate MD5 hash of input</dd>
      <dt>x</dt>
      <dd>A neuron or other object to test/convert</dd>
      <dt>Strict</dt>
      <dd>Whether to check class of neuron or use a more relaxed
definition based on object being a list with a SegList component.</dd>
      <dt>vertexData</dt>
      <dd>A dataframe with SWC fields especially X,Y,Z,W,PointNo,
Parent.</dd>
      <dt>origin</dt>
      <dd>Root vertex, matched against labels (aka PointNo) when 
available (see details)</dd>
      <dt>Verbose</dt>
      <dd>Whether to be verbose (default: FALSE)</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with elements: 
  (NumPoints,StartPoint,BranchPoints,EndPoints,nTrees,NumSegs,SegList, 
  [SubTrees]) NB SubTrees will only be present when nTrees&gt;1.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>neuron objects consist of a list containing multiple fields describing the 3D
location and connectivity of points in a traced neuron. The critical fields 
of a neuron, n, are n$d which contains a dataframe in SWC format and 
n$SegList which contains a representation of the neuron&#39;s topology used for 
most internal calculations. For historical reasons, n$SegList is limited to a
<em>single fully-connected</em> tree. If the tree contains multiple unconnected
subtrees, then these are stored in n$SubTrees and nTrees will be &gt;1; the 
&quot;master&quot; subtree (typically the one with the most points) will then be stored
in n$SegList and n$NumPoints will refer to the number of points in that 
subtree, not the whole neuron.</p>
    <p>StartPoint, BranchPoints, EndPoints are indices matching the rows of 
  the vertices in <code>d</code> <strong>not</strong> arbitrary point numbers typically 
  encoded in <code>d$PointNo</code>.</p>
    <p>Columns will be ordered c(&#39;PointNo&#39;,&#39;Label&#39;,&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;,&#39;W&#39;,&#39;Parent&#39;)</p>
    <p>Uses a depth first search on the tree to reorder using the given 
  origin.</p>
    <p>When the graph contains multiple subgraphs, only one will be chosen 
  as the master tree and used to construct the SegList of the resultant 
  neuron. However all subgraphs will be listed in the SubTrees element of the
  neuron and nTrees will be set appropriately.</p>
    <p>When the graph vertices have a label attribute derived from PointNo,
  the origin is assumed to be specified with respect to the vertex labels 
  rather than the raw vertex ids.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='neuronlist.html'>neuronlist</a></code></p>
    <p><code>graph.dfs, <a href='seglist.html'>as.seglist</a></code></p>
    <p>Other neuron: <code><a href='ngraph.html'>ngraph</a></code>,
  <code><a href='plot.neuron.html'>plot.neuron</a></code>,
  <code><a href='potential_synapses.html'>potential_synapses</a></code>, <code><a href='prune.html'>prune</a></code>,
  <code><a href='resample.html'>resample</a></code>, <code><a href='rootpoints.html'>rootpoints</a></code>,
  <code><a href='spine.html'>spine</a></code>, <code><a href='subset.neuron.html'>subset.neuron</a></code></p>
    

    <h2 class="hasAnchor" id="examples">
      <a class="anchor" href="#examples"></a>
      Examples
    </h2>
    <pre class="examples"><div class='input'><span class='co'>## See help for functions listed in See Also for more detailed examples</span>
<span class='co'>## Basic properties</span>
<span class='co'># a sample neuron </span>
<span class='no'>n</span> <span class='kw'>=</span> <span class='no'>Cell07PNs</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='co'># inspect its internal structure</span>
<span class='fu'>str</span>(<span class='no'>n</span>)</div><div class='output co'>#&gt; List of 24
#&gt;  $ CellType     : chr &quot;DA1&quot;
#&gt;  $ NeuronName   : chr &quot;EBH11R&quot;
#&gt;  $ InputFileName:Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
#&gt;  $ CreatedAt    : POSIXt[1:1], format: &quot;2006-01-17 15:21:14&quot;
#&gt;  $ NodeName     : Named chr &quot;jefferis.joh.cam.ac.uk&quot;
#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;nodename&quot;
#&gt;  $ InputFileStat:&#39;data.frame&#39;:	1 obs. of  10 variables:
#&gt;   ..$ size  : num 15379
#&gt;   ..$ isdir : logi FALSE
#&gt;   ..$ mode  :Class &#39;octmode&#39;  int 420
#&gt;   ..$ mtime : POSIXt[1:1], format: &quot;2006-01-12 00:52:01&quot;
#&gt;   ..$ ctime : POSIXt[1:1], format: &quot;2006-01-12 00:52:01&quot;
#&gt;   ..$ atime : POSIXt[1:1], format: &quot;2006-01-17 15:21:14&quot;
#&gt;   ..$ uid   : int 501
#&gt;   ..$ gid   : int 501
#&gt;   ..$ uname : chr &quot;jefferis&quot;
#&gt;   ..$ grname: chr &quot;jefferis&quot;
#&gt;  $ InputFileMD5 : Named chr &quot;fcacee3f874cbe2c6ad96214e6fee337&quot;
#&gt;   ..- attr(*, &quot;names&quot;)=Class &#39;AsIs&#39;  chr &quot;/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc&quot;
#&gt;  $ NumPoints    : int 180
#&gt;  $ StartPoint   : num 1
#&gt;  $ BranchPoints : num [1:16] 34 48 51 75 78 95 98 99 108 109 ...
#&gt;  $ EndPoints    : num [1:18] 1 42 59 62 80 85 96 100 102 112 ...
#&gt;  $ NumSegs      : int 33
#&gt;  $ SegList      :List of 33
#&gt;   ..$ : int [1:34] 1 2 3 4 5 6 7 8 9 10 ...
#&gt;   ..$ : int [1:9] 34 35 36 37 38 39 40 41 42
#&gt;   ..$ : num [1:7] 34 43 44 45 46 47 48
#&gt;   ..$ : int [1:4] 48 49 50 51
#&gt;   ..$ : int [1:9] 51 52 53 54 55 56 57 58 59
#&gt;   ..$ : num [1:4] 51 60 61 62
#&gt;   ..$ : num [1:14] 48 63 64 65 66 67 68 69 70 71 ...
#&gt;   ..$ : int [1:4] 75 76 77 78
#&gt;   ..$ : int [1:3] 78 79 80
#&gt;   ..$ : num [1:6] 78 81 82 83 84 85
#&gt;   ..$ : num [1:11] 75 86 87 88 89 90 91 92 93 94 ...
#&gt;   ..$ : int [1:2] 95 96
#&gt;   ..$ : num [1:3] 95 97 98
#&gt;   ..$ : int [1:2] 98 99
#&gt;   ..$ : int [1:2] 99 100
#&gt;   ..$ : num [1:3] 99 101 102
#&gt;   ..$ : num [1:7] 98 103 104 105 106 107 108
#&gt;   ..$ : int [1:2] 108 109
#&gt;   ..$ : int [1:4] 109 110 111 112
#&gt;   ..$ : num [1:4] 109 113 114 115
#&gt;   ..$ : int [1:3] 115 116 117
#&gt;   ..$ : num [1:3] 115 118 119
#&gt;   ..$ : int [1:3] 119 120 121
#&gt;   ..$ : num [1:14] 119 122 123 124 125 126 127 128 129 130 ...
#&gt;   ..$ : num [1:2] 108 135
#&gt;   ..$ : int [1:9] 135 136 137 138 139 140 141 142 143
#&gt;   ..$ : int [1:6] 143 144 145 146 147 148
#&gt;   ..$ : num [1:7] 143 149 150 151 152 153 154
#&gt;   ..$ : num [1:7] 135 155 156 157 158 159 160
#&gt;   ..$ : int [1:6] 160 161 162 163 164 165
#&gt;   ..$ : num [1:5] 160 166 167 168 169
#&gt;   ..$ : int [1:4] 169 170 171 172
#&gt;   ..$ : num [1:9] 169 173 174 175 176 177 178 179 180
#&gt;  $ d            :&#39;data.frame&#39;:	180 obs. of  7 variables:
#&gt;   ..$ PointNo: int [1:180] 1 2 3 4 5 6 7 8 9 10 ...
#&gt;   ..$ Label  : num [1:180] 2 2 2 2 2 2 2 2 2 2 ...
#&gt;   ..$ X      : num [1:180] 187 187 188 188 188 ...
#&gt;   ..$ Y      : num [1:180] 133 131 130 129 129 ...
#&gt;   ..$ Z      : num [1:180] 88.2 90.6 93.1 95 97.5 ...
#&gt;   ..$ W      : num [1:180] 1.01 1.27 1.14 1.27 1.27 1.27 1.27 1.27 1.27 1.27 ...
#&gt;   ..$ Parent : num [1:180] -1 1 2 3 4 5 6 7 8 9 ...
#&gt;  $ OrientInfo   :List of 5
#&gt;   ..$ AxonOriented: logi TRUE
#&gt;   ..$ AVMPoint    : logi NA
#&gt;   ..$ AVLPoint    : logi NA
#&gt;   ..$ Scl         : num [1:3] 1 1 1
#&gt;   ..$ NewAxes     : num [1:3] 1 2 3
#&gt;  $ SegOrders    : num [1:33] 1 2 2 3 4 4 3 4 5 5 ...
#&gt;  $ MBPoints     : int [1:2] 34 48
#&gt;  $ LHBranchPoint: int 75
#&gt;  $ SegTypes     : num [1:33] 1 3 1 3 3 3 1 2 2 2 ...
#&gt;  $ AxonSegNos   :List of 3
#&gt;   ..$ PreMBAxons : int 1
#&gt;   ..$ MBAxons    : int 3
#&gt;   ..$ PostMBAxons: int 7
#&gt;  $ LHSegNos     : num [1:26] 8 9 10 11 12 13 14 15 16 17 ...
#&gt;  $ MBSegNos     :List of 2
#&gt;   ..$ : int 2
#&gt;   ..$ : num [1:3] 4 5 6
#&gt;  $ NumMBBranches: num 2
#&gt;  $ AxonLHEP     : num 72
#&gt;  - attr(*, &quot;class&quot;)= chr [1:2] &quot;neuron&quot; &quot;list&quot;
#&gt; </div><div class='input'><span class='co'># summary of 3D points</span>
<span class='fu'><a href='summary.neuronlist.html'>summary</a></span>(<span class='fu'><a href='xyzmatrix.html'>xyzmatrix</a></span>(<span class='no'>n</span>))</div><div class='output co'>#&gt;        X               Y                Z        
#&gt;  Min.   :186.9   Min.   : 90.36   Min.   : 88.2  
#&gt;  1st Qu.:225.6   1st Qu.: 97.56   1st Qu.:103.4  
#&gt;  Median :258.4   Median :102.70   Median :112.9  
#&gt;  Mean   :249.4   Mean   :104.03   Mean   :120.9  
#&gt;  3rd Qu.:277.7   3rd Qu.:109.04   3rd Qu.:139.0  
#&gt;  Max.   :289.5   Max.   :132.71   Max.   :157.3  
#&gt; </div><div class='input'><span class='co'># identify 3d location of endpoints</span>
<span class='fu'><a href='xyzmatrix.html'>xyzmatrix</a></span>(<span class='no'>n</span>)[<span class='fu'><a href='rootpoints.html'>endpoints</a></span>(<span class='no'>n</span>),]</div><div class='output co'>#&gt;            X         Y         Z
#&gt; 1   186.8660 132.70932  88.20393
#&gt; 42  224.7067 109.86362 153.58749
#&gt; 59  229.6343  92.30637 157.29700
#&gt; 62  226.8855  90.36325 147.59602
#&gt; 80  249.8864  93.59079 136.77795
#&gt; 85  253.0099  90.94904 137.34921
#&gt; 96  264.0801  98.53390 121.89463
#&gt; 100 266.3223  98.73241 116.46558
#&gt; 102 267.5460  98.59859 112.85608
#&gt; 112 271.0762 102.67288 100.84955
#&gt; 117 274.6128 100.92061 103.28772
#&gt; 121 277.3920 102.19148 102.69473
#&gt; 134 287.1214 101.43365 103.30740
#&gt; 148 281.7958  96.63987 101.08075
#&gt; 154 276.6551  95.09809  99.22113
#&gt; 165 278.3287 113.75627 104.87700
#&gt; 172 282.3069 111.93213 105.65492
#&gt; 180 289.5364 111.96014 109.18281
#&gt; </div><div class='input'>
<span class='co'>## Neurons as graphs</span>
<span class='co'># convert to graph and find longest paths by number of nodes</span>
<span class='no'>ng</span><span class='kw'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span>(<span class='no'>n</span>)
<span class='fu'>hist</span>(<span class='kw'>igraph</span><span class='kw'>::</span><span class='fu'>distances</span>(<span class='no'>ng</span>))</div><img src='neuron-8.png' alt='' width='540' height='400' /><div class='input'><span class='co'># ... or in distances  microns</span>
<span class='no'>ngw</span><span class='kw'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span>(<span class='no'>n</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>hist</span>(<span class='kw'>igraph</span><span class='kw'>::</span><span class='fu'>distances</span>(<span class='no'>ngw</span>))</div><img src='neuron-10.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>## Other methods</span>
<span class='co'># plot</span>
<span class='fu'>plot</span>(<span class='no'>n</span>)</div><img src='neuron-12.png' alt='' width='540' height='400' /><div class='input'><span class='co'># all methods for neuron objects</span>
<span class='fu'>methods</span>(<span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>'neuron'</span>)</div><div class='output co'>#&gt;  [1] -                  *                  /                  +                 
#&gt;  [5] all.equal          as.neuron          as.ngraph          as.seglist        
#&gt;  [9] boundingbox        branchpoints       dotprops           endpoints         
#&gt; [13] ndigest            plot               plot3d             potential_synapses
#&gt; [17] prune              resample           rootpoints         scale             
#&gt; [21] subset             summary            write.vtk          xform             
#&gt; [25] xyzmatrix          xyzmatrix&lt;-       
#&gt; see &#39;?methods&#39; for accessing help and source code
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm">
    <div id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    </div>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Gregory Jefferis, James Manton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
